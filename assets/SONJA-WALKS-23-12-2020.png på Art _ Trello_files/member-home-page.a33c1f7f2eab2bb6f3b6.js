(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{"./app/scripts/controller/memberHomePage.js":function(e,t,a){function n(e,t){return null!=e?t(e):void 0}var r=a("./packages/jquery/index.js"),i=a("./app/scripts/db/auth.js"),o=a("./app/scripts/lib/localize.js"),s=a("./packages/storage/index.ts").TrelloStorage,l=a("./packages/atlassian-analytics/index.ts"),c=l.Apdex,m=l.Analytics,p=l.getScreenFromUrl,d=a("./app/scripts/lib/util/index.js"),u=a("./packages/analytics/index.ts").trackGTMEvent,g=a("./app/scripts/controller/memberPageHelpers.js"),b=g.isMemberOfOrg,f=g.getHomeLastTab,w=g.redirectHomeToDefaultTab,v=g.getHomeLastTabStorageKey,h=a("./app/scripts/controller/navigate.js").navigate,y=a("./packages/use-lazy-component/index.ts").importWithRetry,S=!1,k=null,H=!1;r(window).on("popstate",(function(){return H=!0}));var j=function(e,t,r,i){var o,s=a("./app/scripts/db/model-cache.js"),l="",c={};if(e&&t&&!r)l="organizationBoardsHomeScreen",c={teamId:n(s.findOne("Organization","name",e),(function(e){return e.id}))};else if(e||!t||r||i)if(e||t||!r||i)if(e||t||r||i){if(!i||e||t||r)return;l="organizationGettingStartedScreen"}else l="memberHomeScreen";else l="templateGalleryScreen";else l="memberBoardsHomeScreen";return m.sendOperationalEvent({action:"rendered",actionSubject:l,source:p(),containers:{organization:{id:null===(o=c)||void 0===o?void 0:o.teamId}}})};e.exports.memberHomePage=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=t.orgname,m=t.showHomeBoardsTab,p=t.showGettingStarted,g=t.templatesData,T=t.titleKey,B=a("./app/scripts/db/model-cache.js");if(!i.isLoggedIn())return this.displayErrorPage();g&&"all"===g.category&&!g.shortLink&&h("/templates",{trigger:!0,replace:!0});var x=function(){switch(!1){case!m:return"memberBoards";default:return"memberHome"}}();return g||c.start({task:x}),B.waitFor("Member",i.myId(),(function(){return y((function(){return a.e(101).then(a.t.bind(null,"./app/scripts/controller/memberPage.js",7))})).then((function(t){var a=t.memberPage,y=d.idToDate(i.myId())>d.dateBefore({minutes:3}),D=n(i.me(),(function(e){return e.isDismissed("sent-possible-new-signup-event")}));(k||!D&&y)&&(u({event:"trello.possibleNewSignup",ed:n(i.me(),(function(e){return e.getEmailDomain()}))}),n(i.me(),(function(e){return e.dismiss("sent-possible-new-signup-event")})));var M=f.call(e);if(!(l||m||p||g||!M||"/"===M||H))return H=!1,c.cancel({task:x}),S=c.isInitialLoad&&c.initialUrl===window.location.href,h(M,{trigger:!0,replace:!0});if(H&&s.set(v(),window.location.pathname),l&&!b(l))return w.call(e);j(l,m,g,p),H=!1,null==k&&(k=r.cookie("simulateNewUser"));var z={username:"me",loadFn:l||m||!g?"loadMemberBoardsData":"loadMinimumMemberDataForTemplatePage",viewClassName:"MemberHomeView",getLocation:function(t){return e.getMemberBoardsUrl(t,l,m,g,p)},titleKey:T||"boards",orgname:l,showHomeBoardsTab:m,showGettingStarted:p,templatesData:g};return a.call(e,z).then((function(){var t=void 0===l?o(["page title","home"]):!l&&m?o(["page title","boards"]):n(B.findOne("Organization","name",l),(function(e){return e.get("displayName")}));return e.title(t)})).tap((function(){if("memberBoards"===x)return S&&c.resetInitialState(),c.stop({task:x}),S=!1})).done()}))}))}}}]);
//# sourceMappingURL=member-home-page.a33c1f7f2eab2bb6f3b6.js.map